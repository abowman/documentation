<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Creo Freehand Drawing class description">
    <title>Creo: Freehand Drawing</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,800">
    <link rel="stylesheet" href="../scripts/highlight/styles/github-gist.css">
    <link rel="stylesheet" href="../stylesheets/styles.css">
  </head>
  <body>

    <!-- Fixed navbar -->
     <nav class="navbar navbar-default navbar-fixed-top">
       <div class="container">
         <div class="navbar-header">
           <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
             <span class="sr-only">Toggle navigation</span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
           </button>
           <a class="navbar-brand" href="http://creolabs.com"><img src="../images/logo.png" width="36" height="36" alt="Creolabs"></a>
         </div>
         <div id="navbar" class="navbar-collapse collapse">
           <ul class="nav navbar-nav navbar-right">
             <li><a href="../creo/what-is-creo.html">Creo</a></li>
             <li><a href="../classes/ActivityIndicator.html">Classes</a></li>
             <li><a href="../gravity/getting-started.html">Gravity</a></li>
             <li class="active"><a href="../tutorials/lets-cook-nav.html">Tutorials</a></li>
           </ul>
         </div><!--/.nav-collapse -->
       </div>
     </nav>

     <div class="container body-container">
       <div class="main-content">
       	<div class="row">
       		<div class="col-sm-3 border-right section-left">
       			<div saveheight="1" class="sidebar-nav">
       			<h4>TUTORIALS</h4>
				<ul>
					<li><a href="browser.html"><span>Browser</span></a></li>
					<li><a href="lets-cook-nav.html"><span>Lets Cook Nav</span></a></li>
					<li><a href="lets-cook-split.html"><span>Lets Cook Split</span></a></li>
					<li><a href="spotify.html"><span>Spotify</span></a></li>
					<li><a href="ebook.html"><span>eBook</span></a></li>
					<li><a href="heart-rate.html"><span>Heart Rate</span></a></li>
					<li><a href="photo-gallery.html"><span>Photo Gallery</span></a></li>
					<li><a href="file-manager.html"><span>File Manager</span></a></li>
					<li><a href="gesture-recognizer.html"><span>Gesture Recognizer</span></a></li>
					<li><a href="freehand-drawing.html" class="active"><span>Freehand Drawing</span></a></li>
					<li><a href="todo.html"><span>ToDo</span></a></li>
				</ul>

       			</div>
       		</div>

       		<div class="col-sm-9 border-left section-right">
         	<h1 class="section-header">Freehand Drawing</h1>
			<hr>
			
			<!-- INTRO -->			
			<p class="section-content">
			<span class="label label-tutorial">Concepts</span><br>
			<ul style="list-style: none;">
			<li>This tutorial will teach you how to implement a drawing algorithm for smooth, freehand drawing on iOS devices using the Draw and Touches event of a View control (code has been adapted from <a href="https://code.tutsplus.com/tutorials/smooth-freehand-drawing-on-ios--mobile-13164">https://code.tutsplus.com/tutorials/smooth-freehand-drawing-on-ios--mobile-13164</a>).
			</li>
			</ul>
			<br>
			</p>
			
			<!-- USED CLASSES -->		
			<p class="section-content">
			<span class="label label-tutorial">Classes</span><br>
			<ul style="list-style: none;">
				<li><a href="../classes/OvalShape.html">OvalShape</a></li>
				<li><a href="../classes/BezierPath.html">BezierPath</a></li>
				<li><a href="../classes/View.html">View</a></li>
				<li><a href="../classes/Button.html">Button</a></li>
				<li><a href="../classes/CameraRoll.html">CameraRoll</a></li>
			</ul>
			<br>
			</p>
						
			<!-- ASSETS TO DOWNLOAD -->
			<p class="section-content">
			<span class="label label-tutorial">Assets</span><br>
			<ul style="list-style: none;">
			<li>None</li>
			</ul>
			<br>
			</p>
						
			<!-- TUTORIAL -->
			<p class="section-content">
			<span class="number-badge"><span>1</span></span> Create a new empty Creo project and drop a View object into the Design Board (make sure to uncheck the Bounces property and to correctly setup its autoresizing mask):
			<img class="section-image fullscreen-shadow"src="../images/tutorials/freehand-drawing-2.png" width="800" height="584" alt="freehand-drawing">
			<br>
			<span class="number-badge"><span>2</span></span> In order to be able to freehand drawing into a View we need to keep track of where the user touches inside that view and convert that gestures into points of a BezierPath object. Lets start by adding a path property to View1:
			<img class="section-image fullscreen-shadow"src="../images/tutorials/freehand-drawing-3.png" width="800" height="584" alt="freehand-drawing">
			<br>
			<span class="number-badge"><span>3</span></span> It is now time to write some Gravity code and in 13 lines you'll get your drawing app. Write the following code to View1's events:
			<pre><code class="swift">
			// EVENT Load
			path = BezierPath();	// initialize a BezierPath object
			path.lineWidth = 2.0;	// set initial line width
			path.strokeColor = Color.gray;	// set initial color
			
			// EVENT TouchesBegan
			var touch = touches[0];	// capture first touch
			var p = touch.locationInView(self); // convert touch coordinates locals to View1
			path.moveToPoint(p); // it is a touch began event to just move to that point
			
			// EVENT TouchesMoved
			var touch = touches[0];	// capture first touch
			var p = touch.locationInView(self);	// convert touch coordinates locals to View1
			path.addLineToPoint(p);	// add that point to the BezierPath
			self.refresh(); // force View1 to call the Draw event
			
			// EVENT TouchesEnded
			self.TouchedMoved(touches, touchInside);
			
			// EVENT TouchesCancelled
			self.TouchedEnded(touches);
			
			// EVENT Draw
			path.stroke();	// stroke resulted path
			
			</code></pre>
			<br>
			<span class="number-badge"><span>4</span></span> That's all you need in order to have a fully functional freehand drawing app. Press RUN and enjoy the app!
			<img class="section-image" src="../images/tutorials/drawing1.gif" width="700" height="493" alt="Freehand Drawing Run">
			<br>
			
			You can now send the app to <a href="../creo/creoplayer.html">CreoPlayer</a> or <a href="../creo/build-your-app.html">build it</a> and then submit to the App Store.
			</p>
						
			<!-- FINAL PROJECT -->
			<p class="section-content">
			<br><br>
			<span class="label label-tutorial">Project</span><br>
			<ul style="list-style: none;">
				<li><a href="../assets/drawing1.zip">FreehandDrawing1.creoproject</a> (12KB)</li>
			</ul>
			<br>
			</p>
			
			<p class="section-content">
			<span class="label label-tutorial">Enhancements</span><br>
			<ul style="list-style: none;">
			<li>We could further enhance this simple project with nice features like color selection and final result saving in CameraRoll. Code changes are minimals, we just need to define an array to keep track of all the BezierPath objects that the user can create.
			</li>
			</ul>
			<br>
			</p>
			
			<!-- TUTORIAL -->
			<p class="section-content">
			<span class="number-badge"><span>5</span></span> Start by dropping some OvalShape into the DesignBoard and set the fillColor property to some color you like more. <strong>Make sure to check the "User Interaction" flag</strong> (and to uncheck the Multiple Touch option) for each OvalShape in the Touch Inspector. Note that we also added a Button with the Title set to Save:
			<img class="section-image fullscreen-shadow"src="../images/tutorials/freehand-drawing-4.png" width="800" height="584" alt="freehand-drawing">
			<br>
			<span class="number-badge"><span>6</span></span> We need to add some new properties to View1, a currentColor property to keep track of user selected color and a paths property that will collect all the BezierPath objects that the user created. We also need a new initPath method which will be responsible to initialize a new BezierPath object each time the user begins a touch:
			<img class="section-image fullscreen-shadow"src="../images/tutorials/freehand-drawing-5.png" width="800" height="584" alt="freehand-drawing">
			<br>
			<span class="number-badge"><span>7</span></span> It is now time to add some Gravity code, so write the following code to View1's events:
			<pre><code class="swift">
			// EVENT Load
			paths = []; // initialize array of paths
			currentColor = Color.black; // set an initial color to use
			
			// EVENT TouchesBegan
			initPath(); // initialize a new BezierPath object each time a touch began
			var touch = touches[0];	// capture first touch
			var p = touch.locationInView(self); // convert touch coordinates locals to View1
			path.moveToPoint(p); // it is a touch began event to just move to that point
			
			// EVENT TouchesMoved (no code changes here)
			var touch = touches[0];	// capture first touch
			var p = touch.locationInView(self);	// convert touch coordinates locals to View1
			path.addLineToPoint(p);	// add that point to the BezierPath
			self.refresh(); // force View1 to call the Draw event
			
			// EVENT TouchesEnded
			paths.push(path); // when touch ended add resulting BezierPath object to the array
			self.TouchedMoved(touches, touchInside);
			
			// EVENT TouchesCancelled
			self.TouchedEnded(touches);
			
			// EVENT Draw
			for (var p in paths) {
				p.stroke(); // stroke saved paths found in the array
			}
			path.stroke();	// stroke current path
			
			// FUNC initPath
			path = BezierPath();	// initialize a BezierPath object
			path.lineWidth = 2.0;	// set initial line width
			path.strokeColor = currentColor;	// set initial color based on user selection
			</code></pre>
			<br>
			We also need to add some code to the OvalShape(s) objects in order to updated currently selected color. Just add this line of code to each OvalShape TouchesBegan event:
			<pre><code class="swift">
			View1.currentColor = self.fillColor; // set current color to be used in path.stroke()
			</code></pre>
			<br>
			Finally if we want to save current drawing into the CameraRoll, add the following code to the Action event of the Save button:
			<pre><code class="swift">
			var image = View1.image();	// get View1 raster image representation
			CameraRoll.saveImage(image); // save image to CameraRoll
			</code></pre>
			<br>
			
			<span class="number-badge"><span>8</span></span> That's all you need in order to have a fully functional advanced freehand drawing app. Press RUN and enjoy the app!
			<img class="section-image" src="../images/tutorials/drawing2.gif" width="700" height="492" alt="Freehand Drawing Run">
			<br>
			
			You can now send the app to <a href="../creo/creoplayer.html">CreoPlayer</a> or <a href="../creo/build-your-app.html">build it</a> and then submit to the App Store.
			</p>
						
			<!-- FINAL PROJECT -->
			<p class="section-content">
			<br><br>
			<span class="label label-tutorial">Project</span><br>
			<ul style="list-style: none;">
				<li><a href="../assets/drawing2.zip">FreehandDrawing2.creoproject</a> (16KB)</li>
			</ul>
			<br>
			</p>
			
			<p class="section-footer"></p>
         	</div>
       	</div> <!-- /row -->
       </div> <!-- /main-content -->
     </div> <!-- /container -->

	<footer class="navbar-fixed-bottom">
      <div class="container footer">
      	<p>
      	<span class="footer-left">Documentation version 20180719</span>
        <span class="footer-right"><a href="http://community.creolabs.com">Community</a> | <a href="http://blog.creolabs.com">Blog</a> | &copy;2018 Creolabs Inc.</span>
        </p>
      </div>
    </footer>
	
	<!-- Bootstrap JS -->
	<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	
	<!-- Highlights JS -->
    <script src="../scripts/highlight/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    
    <!-- Google Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-6839205-1', 'auto');
    ga('send', 'pageview');
	</script>
	</body>
</html>
